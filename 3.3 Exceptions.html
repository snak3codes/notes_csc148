
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="nav"><div>Next: <a href='3.4 Analysis Program Running Time.html'>3.4 Analysis Program Running Time</a>, Previous: <a href='3.2 Stacks And Queues.html'>3.2 Stacks And Queues</a>, Up: <a href='index.html'>Index</a></div></div>
      <div id="titlearea">
        <h2>3.3 Exceptions</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><p>Right now, our stack implementation raises an unfortunate error when client code calls <code>pop</code> on an empty <code>Stack</code></p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">s</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">Stack</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">s</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">Traceback</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">most</span> <span class="ace_identifier">recent</span> <span class="ace_identifier">call</span> <span class="ace_identifier">last</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">File</span> <span class="ace_string">"&lt;input&gt;"</span>, <span class="ace_identifier">line</span> <span class="ace_constant ace_numeric">1</span>, <span class="ace_keyword">in</span> <span class="ace_keyword ace_operator">&lt;</span><span class="ace_identifier">module</span><span class="ace_keyword ace_operator">&gt;</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">File</span> <span class="ace_string">"..."</span>, <span class="ace_identifier">line</span> <span class="ace_constant ace_numeric">58</span>, <span class="ace_keyword">in</span> <span class="ace_identifier">pop</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">return</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_items</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">IndexError</span>: <span class="ace_identifier">pop</span> <span class="ace_keyword">from</span> <span class="ace_identifier">empty</span> <span class="ace_support ace_function">list</span>
</div></div></div></div><div class="cell text-cell"><h2>Alternative: fail silently</h2>
<p>One simple improvement is to make the code “fail silently”, making sure to document this behaviour in the method docstring:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_identifier">Any</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Remove and return the element at the top of this stack.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Do nothing if this stack is empty.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s = Stack()</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s.push('hello')</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s.push('goodbye')</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s.pop()</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    'goodbye'</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    """</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_keyword">not</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">is_empty</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_items</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div></div></div></div><div class="cell text-cell"><p>Because the client code in this case expects a value to be returned, it could use the “no return value” as a sign that something bad happened. However, this approach doesn’t work for all methods; for example, <code>push</code> never returns a value, not even when all goes well, so failing silently would not alert the client code to a problem until potentially hundreds of lines of code later. And in <code>pop</code>, which <em>does</em> return a value, if we treat <code>None</code> as an indication of an error we can never allow client code to push the value <code>None</code>. There may be clients who want to be able to do that, and to recognize it as a legitimate value when it is popped off again.</p>
</div><div class="cell text-cell"><h2>Alternative: Raise a user-defined exception</h2>
<p>A better solution is to raise an error when something has gone wrong, so that the client code has a clear signal. We want the errors to be descriptive, yet not to reveal any implementation details. We can achieve this very easily in Python: we define our own type of error by making a subclass of a built-in class called <code>Exception</code>. For example, here’s how to define our own kind of <code>Exception</code> called <code>EmptyStackError</code>:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">class</span> <span class="ace_identifier">EmptyStackError</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Exception</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_string">"""Exception raised when calling pop on an empty stack."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">pass</span>
</div></div></div></div><div class="cell text-cell"><p>We call this a user-defined exception.</p>
<p>Here’s how we’ll use <code>EmptyStackError</code> in our <code>pop</code> method:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_identifier">Any</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Remove and return the element at the top of this stack.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Raise an EmptyStackError if this stack is empty.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s = Stack()</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s.push('hello')</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s.push('goodbye')</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; s.pop()</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    'goodbye'</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    """</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">is_empty</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">raise</span> <span class="ace_identifier">EmptyStackError</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_items</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">s</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">Stack</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">s</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">Traceback</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">most</span> <span class="ace_identifier">recent</span> <span class="ace_identifier">call</span> <span class="ace_identifier">last</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">File</span> <span class="ace_string">"&lt;input&gt;"</span>, <span class="ace_identifier">line</span> <span class="ace_constant ace_numeric">1</span>, <span class="ace_keyword">in</span> <span class="ace_keyword ace_operator">&lt;</span><span class="ace_identifier">module</span><span class="ace_keyword ace_operator">&gt;</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">File</span> <span class="ace_string">"..."</span>, <span class="ace_identifier">line</span> <span class="ace_constant ace_numeric">60</span>, <span class="ace_keyword">in</span> <span class="ace_identifier">pop</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">raise</span> <span class="ace_identifier">EmptyStackError</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">EmptyStackError</span>
</div></div></div></div><div class="cell text-cell"><p>When we want an <code>EmptyStackError</code> to happen, we construct an instance of that new class and <code>raise</code> it. We have already seen the <code>raise</code> keyword in the context of unimplemented methods in abstract superclasses. It turns out that this mechanism is very flexible, and can be used anywhere in our code to raise exceptions, even ones that we’ve defined ourselves.</p>
<p>Notice that the line which is shown to the client is just this simple <code>raise</code> statement; it doesn’t mention any implementation details of the class. And it specifies that an <code>EmptyStackError</code> was the problem. Defining and raising our own errors enables us to give descriptive messages to the user when they have used our class incorrectly.</p>
</div><div class="cell text-cell"><h2>Customizing the error message</h2>
<p>One current limitation of the above approach is that simply the name of the error class is not necessarily enough to convey a user-friendly error message. We can change this by overriding the inherited <code>__str__</code> method in our class:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">class</span> <span class="ace_identifier">EmptyStackError</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Exception</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_string">"""Exception raised when calling pop on an empty stack."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">__str__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_support ace_function">str</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Return a string representation of this error."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_string">'You called pop on an empty stack. :('</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">s</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">Stack</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">s</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">Traceback</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">most</span> <span class="ace_identifier">recent</span> <span class="ace_identifier">call</span> <span class="ace_identifier">last</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">File</span> <span class="ace_string">"&lt;input&gt;"</span>, <span class="ace_identifier">line</span> <span class="ace_constant ace_numeric">1</span>, <span class="ace_keyword">in</span> <span class="ace_keyword ace_operator">&lt;</span><span class="ace_identifier">module</span><span class="ace_keyword ace_operator">&gt;</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">File</span> <span class="ace_string">"..."</span>, <span class="ace_identifier">line</span> <span class="ace_constant ace_numeric">60</span>, <span class="ace_keyword">in</span> <span class="ace_identifier">pop</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">raise</span> <span class="ace_identifier">EmptyStackError</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">EmptyStackError</span>: <span class="ace_identifier">You</span> <span class="ace_identifier">called</span> <span class="ace_identifier">pop</span> <span class="ace_identifier">on</span> <span class="ace_identifier">an</span> <span class="ace_identifier">empty</span> <span class="ace_identifier">stack</span>. :<span class="ace_paren ace_lparen">(</span>
</div></div></div></div><div class="cell text-cell"><h2>Exceptions interrupt the normal flow of control</h2>
<p>The normal flow of control in a program involves pushing a stack frame whenever a function is called, and popping the current (top) stack frame when we reach a <code>return</code> or reach the end of the function/method. When an exception is raised, something very different happens: <strong>immediately</strong>, the function ends and its stack frame is popped, sending the exception back to the caller, which in turn ends immediately, sending the exception back to <em>its</em> caller, and so on until the stack is empty. At that point, an error message specifying the exception is printed, and the program stops.</p>
<p>In fact, when this happens, much more information is printed. For every stack frame that is popped, there was a function/method that had been running and was at a particular line. The output shows both the line number and line of code. For example, here is a module that defines two useful methods and then a very silly one, <code>mess_about</code>, whose sole purpose is to demonstrate how exceptions work:</p>
</div><div class="cell text-cell"><img src="resources/425D4044AD7DC39B4385C90D954B0BAB.jpg" alt="Code with line numbers." width="647" height="778"></div><div class="cell text-cell"><p>Because <code>mess_about</code> clears the stack, the call to <code>second_from_top</code> is guaranteed to fail when it tries to pop even one thing from the stack. At the moment of failure, we are executing <code>pop</code>, and beneath it on the call stack are <code>second_from_top</code>, <code>mess_about</code>, and the main block of the module, all on pause and waiting to finish their work. When pop raises an <code>EmptyStackError</code>, we see a full report:</p>
</div><div class="cell text-cell"><img src="resources/29DC6AF82E6BE653C331239B93359CC3.jpg" alt="Code with line numbers." width="1049" height="222"></div><div class="cell text-cell"><p>You have undoubtedly seen this kind of error report many times. Now you should be able to use it as a treasure trove of information about what went wrong.</p>
</div><div class="cell text-cell"><h2>Handling exceptions more elegantly</h2>
<p>Your code can be written in a way that takes responsibility for “catching” and handling exceptions. Catching an exception and taking an appropriate action instead of allowing your code to crash is a much more elegant way of dealing with errors because it shields the user from seeing errors that they should never see, and allows the program to continue.</p>
<p>Although we will go through a few examples to give you an idea of how to catch and handle exceptions, please make sure to read the python documentation on <a href="https://docs.python.org/3/tutorial/errors.html">exceptions</a>. You should carefully read the sections on <a href="https://docs.python.org/3/tutorial/errors.html#handling-exceptions">handling exceptions</a> and <a href="https://docs.python.org/3/tutorial/errors.html#defining-clean-up-actions">defining clean-up actions</a>.</p>
<p>Consider a simple example of asking for input from the user in the form of an integer number, and testing if the number is a divisor of 42. We need to make sure that the input is well-formed. That means that we should make sure that it is indeed an integer, as well as check that the number is not going to result in a division by zero. Here is an example of how to catch and handle exceptions in a graceful way in this context:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">if</span> <span class="ace_identifier">__name__</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_string">'__main__'</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">option</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'y'</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">while</span> <span class="ace_identifier">option</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_string">'y'</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">value</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_support ace_function">input</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'Give me an integer to check if it is a divisor of 42: '</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">try</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">is_divisor</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">42</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_support ace_function">int</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">value</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">is_divisor</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">except</span> <span class="ace_identifier">ZeroDivisionError</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"Uh-oh, invalid input: 0 cannot be a divisor of any number!"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">except</span> <span class="ace_identifier">ValueError</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"Type mismatch, expecting an integer!"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">finally</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"Now let's try another number..."</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">option</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_support ace_function">input</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'Would you like to continue (y/n): '</span><span class="ace_paren ace_rparen">)</span>
</div></div></div></div><div class="cell text-cell"><p>In the context of our stack, we can similarly handle an <code>EmptyStackError</code> in a graceful manner. We do not necessarily have to print a message to the user (although we do in the code below), but we must document this exceptional circumstance in the docstring and we must change the return type from a <code>str</code>to <code>Optional[str]</code>.</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">def</span> <span class="ace_identifier">second_from_top</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">s</span>: <span class="ace_identifier">Stack</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_identifier">Optional</span><span class="ace_paren ace_lparen">[</span><span class="ace_support ace_function">str</span><span class="ace_paren ace_rparen">]</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_string">"""Return a reference to the item that is second from the top of s.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_string">    Do not change s.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_string">    </span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_string">    If there is no such item in the Stack, returns None.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_string">    """</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">hold2</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_language">None</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">try</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Pop and remember the top 2 items in s.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">hold1</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">s</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">hold2</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">s</span>.<span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Push them back so that s is exactly as it was.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">s</span>.<span class="ace_identifier">push</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">hold2</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">s</span>.<span class="ace_identifier">push</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">hold1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Return a reference to the item that was second from the top.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">except</span> <span class="ace_identifier">EmptyStackError</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"Cannot return second from top, stack empty"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">return</span> <span class="ace_identifier">hold2</span>
</div></div></div></div></div>
      <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = '3.4 Analysis Program Running Time.html';
if (e.keyCode === 37) window.location.href = '3.2 Stacks And Queues.html';
}</script>
    </body>
    </html>
  