
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="nav"><div>Next: <a href='4.4 Linked Lists and Running Time.html'>4.4 Linked Lists and Running Time</a>, Previous: <a href='4.2 Traversing Linked Lists.html'>4.2 Traversing Linked Lists</a>, Up: <a href='index.html'>Index</a></div></div>
      <div id="titlearea">
        <h2>4.3 Linked List Mutation</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><p>All of the linked list methods we have looked at so far are <em>non-mutating</em>, meaning they did not change the linked list upon which they were called. Here’s a reminder of the basic traversal pattern using a <code>while</code> loop: understanding this is critical before moving on!</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_comment"># self is a LinkedList</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    ... <span class="ace_identifier">curr</span>.<span class="ace_identifier">item</span> ...
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div></div></div></div><div class="cell text-cell"><p>We started with these methods because they’re generally easier to understand than their mutating cousins. Now, we’re going to look at the two major <strong>mutating</strong> operations on linked lists: inserting into and deleting items from a linked list. We’ll start with the simplest version of this: appending a new item to the end of a linked list. Before we start, let’s remind ourselves how this works for built-in lists:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">lst</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">lst</span>.<span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">lst</span>.<span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">2</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">lst</span>.<span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">3</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_operator">&gt;&gt;&gt;</span> <span class="ace_identifier">lst</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_constant ace_numeric">2</span>, <span class="ace_constant ace_numeric">3</span><span class="ace_paren ace_rparen">]</span>
</div></div></div></div><div class="cell text-cell"><h2>Linked list <code>append</code></h2>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">class</span> <span class="ace_identifier">LinkedList</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Add the given item to the end of this linked list."""</span>
</div></div></div></div><div class="cell text-cell"><p>Recall that a <code>LinkedList</code> object has only one attribute, a reference to the <em>first</em> node in the list. Unfortunately, this means that we have some work to do to implement <code>append</code>: before adding the item, we need to find the currently last node in the linked list, and then add the item to the end of that. Let’s start (as recommended!!) by using our basic code template:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Add the given item to the end of this linked list."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    ... <span class="ace_identifier">curr</span>.<span class="ace_identifier">item</span> ...
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div></div></div></div><div class="cell text-cell"><p>This template is a good start, but now our thinking must begin. First: what do we do with <code>curr.item</code>? The answer is “Nothing!”—we don’t need to actually use any of the existing items in the list, and instead are just going through the list to get to the last node. Unfortunately, there’s a problem with the loop: this loop is designed to keep going until we’ve processed all of the elements of the list, and <code>curr</code> becomes <code>None</code>. But this is actually going too far for our purposes: we want to stop the loop as soon as we reach the last node.&nbsp;We modify our loop condition to check whether the current node is the last one by using <code>curr.next is None</code> instead.</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span> <span class="ace_keyword">def</span> <span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Add the given item to the end of this linked list."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># After the loop, curr is the last node in the LinkedList.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is not None and curr.next is None</span>
</div></div></div></div><div class="cell text-cell"><p>At this point, the astute reader will point out a flaw in this change: we aren’t guaranteed that <code>curr</code> starts off as a node—it could be <code>None</code>. But because we don’t want to get bogged down with handling that case right now, we’ll add a TODO comment in our code and keep going.</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Add the given item to the end of this linked list."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span>:   <span class="ace_comment"># TODO: what if curr starts off as None?</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># After the loop, curr is the last node in the LinkedList.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is not None and curr.next is None</span>
</div></div></div></div><div class="cell text-cell"><p>So then after the loop ends, we know that <code>curr</code> refers to the last node in the linked list, and we are finally in a position to add the given item to the linked list. To do so, we need to create a new node and then connect it in.</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Add the given item to the end of this linked list."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span>:   <span class="ace_comment"># TODO: what is curr starts off as None?</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># After the loop, curr is the last node in the LinkedList.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is not None and curr.next is None</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>
</div></div></div></div><div class="cell text-cell"><p>And finally, let’s handle that TODO. We know from the documentation of our <code>LinkedList</code> class that <code>self._first</code> can only be <code>None</code> if <code>self</code> refers to an empty linked list. But in this case, all we need to do is add the new item to be the first item in the linked list.</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Add the given item to the end of this linked list."""</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># After the loop, curr is the last node in the LinkedList.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is not None and curr.next is None</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>
</div></div></div></div><div class="cell text-cell"><h3>Example: a more general initializer</h3>
<p>With our <code>append</code> method in place, we can now stop creating linked lists by manually fiddling with attributes, and instead modify our linked list initializer to take in a list of values, which we’ll then append one at a time:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">class</span> <span class="ace_identifier">LinkedList</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">__init__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">items</span>: <span class="ace_support ace_function">list</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Initialize a new linked list containing the given items.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    The first node in the linked list contains the first item</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    in &lt;items&gt;.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    """</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_language">None</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">for</span> <span class="ace_identifier">item</span> <span class="ace_keyword">in</span> <span class="ace_identifier">items</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">append</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div></div></div></div><div class="cell text-cell"><p>While this code is perfectly correct, it turns out that it is rather inefficient; we’ll leave it as an exercise for now to develop a better approach.</p>
</div><div class="cell text-cell"><h2>Index-based insertion</h2>
<p>Now suppose we want to implement a more general form of insertion that allows the user to specify the index of the list to insert a new item into (analogous to the built-in <code>list.insert</code> method):</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">class</span> <span class="ace_identifier">LinkedList</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">insert</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Insert a new node containing item at position &lt;index&gt;.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Precondition: index &gt;= 0.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Raise IndexError if index &gt; len(self).</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Note: if index == len(self), this method adds the item to the end</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    of the linked list, which is the same as LinkedList.append.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; lst = LinkedList([1, 2, 10, 200])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; lst.insert(2, 300)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; str(lst)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    '[1 -&gt; 2 -&gt; 300 -&gt; 10 -&gt; 200]'</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; lst.insert(5, -1)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; str(lst)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    '[1 -&gt; 2 -&gt; 300 -&gt; 10 -&gt; 200 -&gt; -1]'</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    """</span>
</div></div></div></div><div class="cell text-cell"><p>As with <code>append</code>, our first step is to traverse the list until we reach the correct index; and if we want the node to be inserted into position <code>index</code>, we need to access the node at position <code>(index-1)</code>! To write the code, we need to modify our code template to store not just the current node, but the current index of that node as well:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">def</span> <span class="ace_identifier">insert</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span> <span class="ace_keyword">and</span> <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">&lt;</span> <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_constant ace_numeric">1</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">+=</span> <span class="ace_constant ace_numeric">1</span>
</div></div></div></div><div class="cell text-cell"><p>This loop condition is a bit more complicated, so it’s worth spending some time to unpack. Here, we’re saying that the loop should keep going when the current node is not <code>None</code> <em>and</em> when the current index is less than our target index (<code>index - 1</code>). This means that when the loop is over, the current node is <code>None</code><em>or</em> the current index has reached the target index (or both!). We therefore need to structure our code into two cases, and handle each one separately:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">insert</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span> <span class="ace_keyword">and</span> <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">&lt;</span> <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_constant ace_numeric">1</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">+=</span> <span class="ace_constant ace_numeric">1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is None or curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">pass</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>: <span class="ace_comment"># curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">pass</span>
</div></div></div></div><div class="cell text-cell"><p>Now, if <code>curr</code> is <code>None</code> then the list doesn’t have a node at position <code>index - 1</code>, and so that index is out of bounds. In this case, we should raise an <code>IndexError</code>.</p>
<p>On the other hand, if <code>curr</code> is not <code>None</code>, then we’ve reached the desired index, and can insert the new node using the same strategy as <code>append</code>.</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">insert</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span> <span class="ace_keyword">and</span> <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">&lt;</span> <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_constant ace_numeric">1</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">+=</span> <span class="ace_constant ace_numeric">1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is None or curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># index - 1 is out of bounds. The item cannot be inserted.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">raise</span> <span class="ace_identifier">IndexError</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>: <span class="ace_comment"># curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># index - 1 is in bounds. Insert the new item.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>  <span class="ace_comment"># Hmm...</span>
</div></div></div></div><div class="cell text-cell"><p>Well, almost. The problem with the last <code>else</code> branch is that unlike <code>append</code>, <code>curr</code> might have had other nodes after it! Simply setting <code>curr.next = new_node</code> loses the reference to the old node at position <code>index</code>, and any subsequent nodes after that one. So before overwriting <code>curr.next</code>, we need to update <code>new_node</code> so that it refers to the old node at position <code>index</code>:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">insert</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span>, <span class="ace_identifier">item</span>: <span class="ace_support ace_function">object</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span> <span class="ace_keyword">and</span> <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">&lt;</span> <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_constant ace_numeric">1</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">+=</span> <span class="ace_constant ace_numeric">1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is None or curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># index - 1 is out of bounds. The item cannot be inserted.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">raise</span> <span class="ace_identifier">IndexError</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>: <span class="ace_comment"># curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># index - 1 is in bounds. Insert the new item.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>  <span class="ace_comment"># THIS LINE IS IMPORTANT!</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>
</div></div></div></div><div class="cell text-cell"><h3>Warning! Common error ahead! (and solution)</h3>
<p>When writing mutating methods on linked lists, we very often update the links of individual nodes to add and remove nodes in the list. We must be very careful when doing so, because the order in which we update the links really matters, and often only one order results in the correct behaviour.</p>
<p>For example, this order of link updates in the final <code>else</code> branch doesn’t work:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">new_node</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div></div></div></div><div class="cell text-cell"><p>On the second line, <code>curr.next</code> has already been updated, and its old value lost. The second line is now equivalent to writing <code>new_node.next = new_node</code>, which is certainly not what we want!</p>
<p>The reason this type of error is so insidious is that the code <em>looks</em> very similar to the correct code (only the order of lines is different), and so you can only detect it by carefully tracing through the updates of the links line-by-line.</p>
<p>To mitigate this problem, we’ll take advantage of a pretty nice Python feature known as <em>multiple</em> (or <em>simultaneous</em>) <em>assignment</em>:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">a</span>, <span class="ace_identifier">b</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1</span>, <span class="ace_constant ace_numeric">2</span>  <span class="ace_comment"># Assigns 1 to a and 2 to b</span>
</div></div></div></div><div class="cell text-cell"><p>The beauty of this approach is that the expressions on the right side are <em>all</em> evaluated before any new values are assigned, meaning that you don’t need to worry about the order in which you write them. For example, these two assignment statements are <em>equivalent</em>:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_comment"># Version 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>, <span class="ace_identifier">new_node</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>, <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_comment"># Version 2</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">new_node</span>.<span class="ace_support ace_function">next</span>, <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>, <span class="ace_identifier">new_node</span>
</div></div></div></div><div class="cell text-cell"><p>In other words, using multiple assignment in this linked list method allows us to ignore the tricky business about the order in which the link updates happen! We strongly recommend using multiple assignment in your own code when working with complex state updating.</p>
</div><div class="cell text-cell"><h3>Tidying up: don’t forget about corner cases!</h3>
<p>Our <code>insert</code> implementation has one problem: what if <code>index = 0</code>? In this case, it doesn’t make sense to iterate to the (<code>index-1</code>)-th node! This is again a special case which we need to handle separately, by modifying <code>self._first</code> (because in this case, we’re inserting into the front of a linked list):</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">insert</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span>, <span class="ace_identifier">item</span>: <span class="ace_identifier">Any</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>, <span class="ace_identifier">new_node</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>, <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">_first</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_keyword">not</span> <span class="ace_constant ace_language">None</span> <span class="ace_keyword">and</span> <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">&lt;</span> <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_constant ace_numeric">1</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr_index</span> <span class="ace_keyword ace_operator">+=</span> <span class="ace_constant ace_numeric">1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># assert curr is None or curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">curr</span> <span class="ace_keyword">is</span> <span class="ace_constant ace_language">None</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># index - 1 is out of bounds. The item cannot be inserted.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">raise</span> <span class="ace_identifier">IndexError</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>: <span class="ace_comment"># curr_index == index - 1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># index - 1 is in bounds. Insert the new item.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">new_node</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">_Node</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">item</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>, <span class="ace_identifier">new_node</span>.<span class="ace_support ace_function">next</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">new_node</span>, <span class="ace_identifier">curr</span>.<span class="ace_support ace_function">next</span>
</div></div></div></div><div class="cell text-cell"><h2>Exercise: Index-based deletion</h2>
<p>The analogue of Python’s <code>list.append</code> is <code>list.pop</code>, which allows the user to <em>remove</em> an item at a specified index in a list. Because this is quite similar to insertion, we won’t develop the full code here, but instead outline the basic steps in some pseudo-code:</p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">class</span> <span class="ace_identifier">LinkedList</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">def</span> <span class="ace_identifier">pop</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">index</span>: <span class="ace_support ace_function">int</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">-&gt;</span> <span class="ace_identifier">Any</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_string">"""Remove and return node at position &lt;index&gt;.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Precondition: index &gt;= 0.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    Raise IndexError if index &gt;= len(self).</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; lst = LinkedList([1, 2, 10, 200])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; lst.pop(2)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    10</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    &gt;&gt;&gt; lst.pop(0)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_string">    """</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Warning: the following is pseudo-code, not valid Python code!</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># 1. If the list is empty, you know for sure that index is out of bounds...</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># 2. Else if index is 0, remove the first node and return its item.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># 3. Else iterate to the (index-1)-th node and update links to remove</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#    the node at position index. But don't forget to return the item!</span>
</div></div></div></div></div>
      <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = '4.4 Linked Lists and Running Time.html';
if (e.keyCode === 37) window.location.href = '4.2 Traversing Linked Lists.html';
}</script>
    </body>
    </html>
  